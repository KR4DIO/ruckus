#lang racket

(provide
  color?
  normalize-color)

(define (list-color? v)
  (and (list? v)
       (eq? 3 (length v))
       (andmap real? v)))

(define (symbolic-color? v)
  (and (symbol? v)
       (hash-has-key? colors-table v)))

(define (color? v)
  (or (list-color? v) (symbolic-color? v)))

(define (normalize-color v)
  (cond
    [(list-color? v)
     (map (lambda (c) (max 0 (min 1 c))) v)]
    [(symbolic-color? v)
     (hash-ref colors-table v)]
    [else (raise-argument-error 'normalize-color
                                "color?"
                                v)]))

; These are the X11 color names, widely known because of their inclusion in the
; HTML colors.
;
; Table generated from the contents of this page:
; https://en.wikipedia.org/wiki/Web_colors
(define colors-table
  (hasheq
    'pink '(1 64/85 203/255)
    'light-pink '(1 182/255 193/255)
    'hot-pink '(1 7/17 12/17)
    'deep-pink '(1 4/51 49/85)
    'pale-violet-red '(73/85 112/255 49/85)
    'medium-violet-red '(199/255 7/85 133/255)
    'light-salmon '(1 32/51 122/255)
    'salmon '(50/51 128/255 38/85)
    'dark-salmon '(233/255 10/17 122/255)
    'light-coral '(16/17 128/255 128/255)
    'indian-red '(41/51 92/255 92/255)
    'crimson '(44/51 4/51 4/17)
    'fire-brick '(178/255 2/15 2/15)
    'dark-red '(139/255 0 0)
    'red '(1 0 0)
    'orange-red '(1 23/85 0)
    'tomato '(1 33/85 71/255)
    'coral '(1 127/255 16/51)
    'dark-orange '(1 28/51 0)
    'orange '(1 11/17 0)
    'yellow '(1 1 0)
    'light-yellow '(1 1 224/255)
    'lemon-chiffon '(1 50/51 41/51)
    'light-goldenrod-yellow '(50/51 50/51 14/17)
    'papaya-whip '(1 239/255 71/85)
    'moccasin '(1 76/85 181/255)
    'peach-puff '(1 218/255 37/51)
    'pale-goldenrod '(14/15 232/255 2/3)
    'khaki '(16/17 46/51 28/51)
    'dark-khaki '(63/85 61/85 107/255)
    'gold '(1 43/51 0)
    'cornsilk '(1 248/255 44/51)
    'blanched-almond '(1 47/51 41/51)
    'bisque '(1 76/85 196/255)
    'navajo-white '(1 74/85 173/255)
    'wheat '(49/51 74/85 179/255)
    'burly-wood '(74/85 184/255 9/17)
    'tan '(14/17 12/17 28/51)
    'rosy-brown '(188/255 143/255 143/255)
    'sandy-brown '(244/255 164/255 32/85)
    'goldenrod '(218/255 11/17 32/255)
    'dark-goldenrod '(184/255 134/255 11/255)
    'peru '(41/51 133/255 21/85)
    'chocolate '(14/17 7/17 2/17)
    'saddle-brown '(139/255 23/85 19/255)
    'sienna '(32/51 82/255 3/17)
    'brown '(11/17 14/85 14/85)
    'maroon '(128/255 0 0)
    'dark-olive-green '(1/3 107/255 47/255)
    'olive '(128/255 128/255 0)
    'olive-drab '(107/255 142/255 7/51)
    'yellow-green '(154/255 41/51 10/51)
    'lime-green '(10/51 41/51 10/51)
    'lime '(0 1 0)
    'lawn-green '(124/255 84/85 0)
    'chartreuse '(127/255 1 0)
    'green-yellow '(173/255 1 47/255)
    'spring-green '(0 1 127/255)
    'medium-spring-green '(0 50/51 154/255)
    'light-green '(48/85 14/15 48/85)
    'pale-green '(152/255 251/255 152/255)
    'dark-sea-green '(143/255 188/255 143/255)
    'medium-aquamarine '(2/5 41/51 2/3)
    'medium-sea-green '(4/17 179/255 113/255)
    'sea-green '(46/255 139/255 29/85)
    'forest-green '(2/15 139/255 2/15)
    'green '(0 128/255 0)
    'dark-green '(0 20/51 0)
    'aqua '(0 1 1)
    'cyan '(0 1 1)
    'light-cyan '(224/255 1 1)
    'pale-turquoise '(35/51 14/15 14/15)
    'aquamarine '(127/255 1 212/255)
    'turquoise '(64/255 224/255 208/255)
    'medium-turquoise '(24/85 209/255 4/5)
    'dark-turquoise '(0 206/255 209/255)
    'light-sea-green '(32/255 178/255 2/3)
    'cadet-blue '(19/51 158/255 32/51)
    'dark-cyan '(0 139/255 139/255)
    'teal '(0 128/255 128/255)
    'light-steel-blue '(176/255 196/255 74/85)
    'powder-blue '(176/255 224/255 46/51)
    'light-blue '(173/255 72/85 46/51)
    'sky-blue '(9/17 206/255 47/51)
    'light-sky-blue '(9/17 206/255 50/51)
    'deep-sky-blue '(0 191/255 1)
    'dodger-blue '(2/17 48/85 1)
    'cornflower-blue '(20/51 149/255 79/85)
    'steel-blue '(14/51 26/51 12/17)
    'royal-blue '(13/51 7/17 15/17)
    'blue '(0 0 1)
    'medium-blue '(0 0 41/51)
    'dark-blue '(0 0 139/255)
    'navy '(0 0 128/255)
    'midnight-blue '(5/51 5/51 112/255)
    'lavender '(46/51 46/51 50/51)
    'thistle '(72/85 191/255 72/85)
    'plum '(13/15 32/51 13/15)
    'violet '(14/15 26/51 14/15)
    'orchid '(218/255 112/255 214/255)
    'fuchsia '(1 0 1)
    'magenta '(1 0 1)
    'medium-orchid '(62/85 1/3 211/255)
    'medium-purple '(49/85 112/255 73/85)
    'blue-violet '(46/85 43/255 226/255)
    'dark-violet '(148/255 0 211/255)
    'dark-orchid '(3/5 10/51 4/5)
    'dark-magenta '(139/255 0 139/255)
    'purple '(128/255 0 128/255)
    'indigo '(5/17 0 26/51)
    'dark-slate-blue '(24/85 61/255 139/255)
    'rebecca-purple '(2/5 1/5 3/5)
    'slate-blue '(106/255 6/17 41/51)
    'medium-slate-blue '(41/85 104/255 14/15)
    'white '(1 1 1)
    'snow '(1 50/51 50/51)
    'honeydew '(16/17 1 16/17)
    'mint-cream '(49/51 1 50/51)
    'azure '(16/17 1 1)
    'alice-blue '(16/17 248/255 1)
    'ghost-white '(248/255 248/255 1)
    'white-smoke '(49/51 49/51 49/51)
    'seashell '(1 49/51 14/15)
    'beige '(49/51 49/51 44/51)
    'old-lace '(253/255 49/51 46/51)
    'floral-white '(1 50/51 16/17)
    'ivory '(1 1 16/17)
    'antique-white '(50/51 47/51 43/51)
    'linen '(50/51 16/17 46/51)
    'lavender-blush '(1 16/17 49/51)
    'misty-rose '(1 76/85 15/17)
    'gainsboro '(44/51 44/51 44/51)
    'light-grey '(211/255 211/255 211/255)
    'silver '(64/85 64/85 64/85)
    'dark-gray '(169/255 169/255 169/255)
    'gray '(128/255 128/255 128/255)
    'dim-gray '(7/17 7/17 7/17)
    'light-slate-gray '(7/15 8/15 3/5)
    'slate-gray '(112/255 128/255 48/85)
    'dark-slate-gray '(47/255 79/255 79/255)
    'black '(0 0 0)))
